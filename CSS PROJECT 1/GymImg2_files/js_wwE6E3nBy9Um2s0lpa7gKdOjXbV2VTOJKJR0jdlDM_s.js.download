(function(t,e){if(typeof define==='function'&&define.amd){define(e)}
else if(typeof exports==='object'){module.exports=e()}
else{t.Blazy=e()}})(this,function(){'use strict';var r,t,p,d,T='src',v='srcset';return function(s){if(!document.querySelectorAll){var a=document.createStyleSheet();document.querySelectorAll=function(t,e,o,n,s){s=document.all,e=[],t=t.replace(/\[for\b/gi,'[htmlFor').split(',');for(o=t.length;o--;){a.addRule(t[o],'k:v');for(n=s.length;n--;)s[n].currentStyle.k&&e.push(s[n]);a.removeRule(0)};return e}};var n=this,i=n._util={};i.elements=[];i.destroyed=!0;n.options=s||{};n.options.error=n.options.error||!1;n.options.offset=n.options.offset||100;n.options.root=n.options.root||document;n.options.success=n.options.success||!1;n.options.selector=n.options.selector||'.b-lazy';n.options.separator=n.options.separator||'|';n.options.containerClass=n.options.container;n.options.container=n.options.containerClass?document.querySelectorAll(n.options.containerClass):!1;n.options.errorClass=n.options.errorClass||'b-error';n.options.breakpoints=n.options.breakpoints||!1;n.options.loadInvisible=n.options.loadInvisible||!1;n.options.successClass=n.options.successClass||'b-loaded';n.options.validateDelay=n.options.validateDelay||25;n.options.saveViewportOffsetDelay=n.options.saveViewportOffsetDelay||50;n.options.srcset=n.options.srcset||'data-srcset';n.options.src=r=n.options.src||'data-src';d=Element.prototype.closest;p=window.devicePixelRatio>1;t={};t.top=0-n.options.offset;t.left=0-n.options.offset;n.revalidate=function(){m(n)};n.load=function(t,e){var n=this.options;if(t&&t.length===undefined){g(t,e,n)}
else{o(t,function(t){g(t,e,n)})}};n.destroy=function(){var t=n._util;if(n.options.container){o(n.options.container,function(o){e(o,'scroll',t.validateT)})};e(window,'scroll',t.validateT);e(window,'resize',t.validateT);e(window,'resize',t.saveViewportOffsetT);t.count=0;t.elements.length=0;t.destroyed=!0};i.validateT=E(function(){h(n)},n.options.validateDelay,n);i.saveViewportOffsetT=E(function(){C(n.options.offset)},n.options.saveViewportOffsetDelay,n);C(n.options.offset);o(n.options.breakpoints,function(t){if(t.width>=window.screen.width){r=t.src;return!1}});setTimeout(function(){m(n)})};function m(t){var e=t._util;e.elements=D(t.options);e.count=e.elements.length;if(e.destroyed){e.destroyed=!1;if(t.options.container){o(t.options.container,function(t){n(t,'scroll',e.validateT)})};n(window,'resize',e.saveViewportOffsetT);n(window,'resize',e.validateT);n(window,'scroll',e.validateT)};h(t)};function h(t){var o=t._util;for(var e=0;e<o.count;e++){var n=o.elements[e];if(A(n,t.options)||f(n,t.options.successClass)){t.load(n);o.elements.splice(e,1);o.count--;e--}};if(o.count===0){t.destroy()}};function A(e,o){var f=e.getBoundingClientRect();if(o.container&&d){var l=e.closest(o.containerClass);if(l){var n=l.getBoundingClientRect();if(a(n,t)){var s=n.top-o.offset,i=n.right+o.offset,r=n.bottom+o.offset,c=n.left-o.offset,u={top:s>t.top?s:t.top,right:i<t.right?i:t.right,bottom:r<t.bottom?r:t.bottom,left:c>t.left?c:t.left};return a(f,u)}
else{return!1}}};return a(f,t)};function a(t,e){return t.right>=e.left&&t.bottom>=e.top&&t.left<=e.right&&t.top<=e.bottom};function g(t,a,i){if(!f(t,i.successClass)&&(a||i.loadInvisible||(t.offsetWidth>0&&t.offsetHeight>0))){var O=s(t,r)||s(t,i.src);if(O){var C=O.split(i.separator),m=C[p&&C.length>1?1:0],E=s(t,i.srcset),A=l(t,'img'),b=t.parentNode,D=b&&l(b,'picture');if(A||t.src===undefined){var d=new Image(),h=function(){if(i.error)i.error(t,'invalid');u(t,i.errorClass);e(d,'error',h);e(d,'load',g)},g=function(){if(A){if(!D){y(t,m,E)}}
else{t.style.backgroundImage='url("'+m+'")'};c(t,i);e(d,'load',g);e(d,'error',h)};if(D){d=t;o(b.getElementsByTagName('source'),function(t){w(t,v,i.srcset)})};n(d,'error',h);n(d,'load',g);y(d,m,E)}
else{t.src=m;c(t,i)}}
else{if(l(t,'video')){o(t.getElementsByTagName('source'),function(t){w(t,T,i.src)});t.load();c(t,i)}
else{if(i.error)i.error(t,'missing');u(t,i.errorClass)}}}};function c(t,e){u(t,e.successClass);if(e.success)e.success(t);i(t,e.src);i(t,e.srcset);o(e.breakpoints,function(e){i(t,e.src)})};function w(t,e,o){var n=s(t,o);if(n){b(t,e,n);i(t,o)}};function y(t,e,o){if(o){b(t,v,o)};t.src=e};function b(t,e,o){t.setAttribute(e,o)};function s(t,e){return t.getAttribute(e)};function i(t,e){t.removeAttribute(e)};function l(t,e){return t.nodeName.toLowerCase()===e};function f(t,e){return(' '+t.className+' ').indexOf(' '+e+' ')!==-1};function u(t,e){if(!f(t,e)){t.className+=' '+e}};function D(t){var o=[],n=(t.root).querySelectorAll(t.selector);for(var e=n.length;e--;o.unshift(n[e])){};return o};function C(e){t.bottom=(window.innerHeight||document.documentElement.clientHeight)+e;t.right=(window.innerWidth||document.documentElement.clientWidth)+e};function n(t,e,o){if(t.attachEvent){t.attachEvent&&t.attachEvent('on'+e,o)}
else{t.addEventListener(e,o,{capture:!1,passive:!0})}};function e(t,e,o){if(t.detachEvent){t.detachEvent&&t.detachEvent('on'+e,o)}
else{t.removeEventListener(e,o,{capture:!1,passive:!0})}};function o(t,e){if(t&&e){var n=t.length;for(var o=0;o<n&&e(t[o],o)!==!1;o++){}}};function E(t,e,o){var n=0;return function(){var s=+new Date();if(s-n<e){return};n=s;t.apply(o,arguments)}}});;
